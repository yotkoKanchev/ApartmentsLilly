<div *ngIf='apartment' class="jumbotron">

    <div class="row d-flex justify-content-center">
        <div class="col-lg-5 mb-2">
            <div class="mb-2">
                <input type="button" class="btn btn-primary mr-2" routerLink="/apartments/edit/{{apartment.id}}"
                    value="Edit Info">
                <input type="button" class="btn btn-primary mr-2" routerLink="/apartments" value="Back to list">
            </div>
            <div class="card" style="max-width: 26rem;">
                <img [src]="apartment.mainImageUrl" class="card-img-top" alt="Apartment {{apartment.name}}">
                <h3 class="p-2 card-title">{{apartment.name}}</h3>
                <div class="card-body">
                    <h5 *ngIf="apartment.basePrice">Base price: {{apartment.basePrice}}</h5>
                    <h5 *ngIf="apartment.maxOccupants">Max occupants: {{apartment.maxOccupants}}</h5>
                    <h5 *ngIf="apartment.size">SIze: {{apartment.size}}sq.m</h5>
                    <h5>Entry: {{apartment.entry}}</h5>
                    <h5>Fllor: {{apartment.floor}}</h5>
                    <h5>Number: {{apartment.number}}</h5>
                    <p>Description: {{apartment.description}}</p>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="mb-2">
                <input type="button" class="btn btn-primary mr-2" (click)="openModal('add-room-modal')"
                    value="Add Room">
                <input type="button" class="btn btn-primary mr-2" (click)="openModal('add-amenity-modal')"
                    value="Add Amenity">
                <input type="button" class="btn btn-primary mr-2" (click)="openModal('add-bed-modal')" value="Add Bed">
            </div>
            <div class="mb-3 form-group">
                <h5>Address:</h5>
                <div class="row d-flex justify-content-between ml-0 border rounded border-success p-2">
                    <div>
                        <p class="mb-1">{{apartment.address.city}}, {{apartment.address.country}}</p>
                        <p class="mb-1" *ngIf="apartment.address.postalCode && apartment.address.neighborhood">
                            {{apartment.address.postalCode}}, кв. {{apartment.address.neighborhood}}</p>
                        <p class="mb-1">ул. {{apartment.address.streetAddress}}</p>
                    </div>
                    <div>
                        <input type="button" class="btn btn-sm btn-outline-primary mr-2"
                            routerLink="/apartments/{{apartment.id}}/changeAddress" value="Change">
                        <input id="btn" type="button" class="btn btn-sm btn-outline-primary"
                            [routerLink]="['/addresses/edit', apartment.address.id, id]" value="Edit">
                    </div>
                </div>
            </div>
            <div class="form-group" *ngIf="apartment.rooms">
                <h5>Rooms</h5>
                <div class="row ml-0 border rounded border-success p-2 mb-2 d-flex flex-column "
                    *ngFor="let room of apartment.rooms">
                    <div class="d-flex justify-content-between">
                        <div><strong>{{room.roomType.name}}</strong>
                            <span *ngIf="room.isSleepable">(sleepable)</span><strong>:</strong>
                            {{room.name}}
                        </div>
                        <div>
                            <input id="btn" type="button" class="btn btn-sm btn-outline-primary mr-2"
                                routerLink="/rooms/edit/{{room.id}}" value="Edit">
                            <input type="button" class="btn btn-sm btn-outline-primary" (click)="deleteRoom(room.id)"
                                value="Delete">

                        </div>
                    </div>
                    <div *ngIf="room.beds.length > 0">
                        <div class="mr-2"><strong>Beds: </strong>
                            <div style="display: inline-block;" *ngFor="let bed of room.beds; let i= index">
                                <a id="color-red" (click)="deleteBed(bed.id)">{{bed.bedType.name}}</a>
                                <span class="mr-1" *ngIf="i < room.beds.length-1">,</span>
                            </div>

                        </div>
                    </div>
                    <div *ngIf="room.amenities.length > 0">
                        <div class="mr-2"><strong>Amenities: </strong>
                            <div style="display: inline-block;" *ngFor="let amenity of room.amenities; let i= index"
                                [ngClass]="{'high': amenity.importance.name == 'High',
                                'medium': amenity.importance.name == 'Medium', 
                                'normal': amenity.importance.name == 'Normal', 
                                'low': amenity.importance.name == 'Low'}">
                                <a id="color-red" (click)="deleteAmenity(amenity.id, room.id)">{{amenity.name}}</a>
                                <span class="mr-1" *ngIf="i < room.amenities.length-1">,</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group" *ngIf="apartment.amenities">
                <h5>Apartment Amenities:</h5>
                <div class="row ml-0 border rounded border-success p-2 mb-1 d-flex">
                    <div *ngFor="let amenity of apartment.amenities; let i= index" 
                    [ngClass]="{'high': amenity.importance.name == 'High',
                    'medium': amenity.importance.name == 'Medium', 
                    'normal': amenity.importance.name == 'Normal', 
                    'low': amenity.importance.name == 'Low'}">
                        <a id="color-red" (click)="deleteAmenity(amenity.id)">{{amenity.name}}</a>
                        <span class="mr-1" *ngIf="i < apartment.amenities.length-1">,</span>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <jw-modal id="add-room-modal">
        <div>
            <app-create-room [apartmentId]='id'></app-create-room>
        </div>
    </jw-modal>

    <jw-modal id="add-amenity-modal">
        <div>
            <app-create-amenity [apartmentId]='id'></app-create-amenity>
        </div>
    </jw-modal>

    <jw-modal id="add-bed-modal">
        <div>
            <app-create-bed [rooms]='apartment.rooms'></app-create-bed>
        </div>
    </jw-modal>

    <jw-modal id="choose-address-modal">
        <div>
            <app-choose-address></app-choose-address>
        </div>
    </jw-modal>